from matplotlib import pyplot as plt
import numpy as np

w = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0012744625623618601, 0.00764677537417116, 0.010195700498894881, 0.0019116938435434908, 8.766691430630504e-09, 4.9677898130248273e-08, 6.7211270462084788e-08, 1.1688916525801521e-08, 0.0, 1.444616131000925e-05, 8.1119862568306014e-05, 7.5540788995653464e-05, 1.8881439516868146e-05, 1.1102648332469289e-06, 0.0, 0.00095119093598201442, 0.0076095274878561154, 0.010463100295802158, 0.0019023818719640288, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00063723128118093003, 0.017842478185516306, 0.074560514832201039, 0.072031573318249345, 0.017210801150737157, 1.1104472278925088e-07, 3.8865648571428562e-07, 3.5358972745010663e-07, 8.7666873943511207e-08, 0.0, 7.4460586019206064e-05, 0.00021782349654146785, 0.00038527683319452817, 0.010386666704597914, 0.062892241190875442, 0.11967888724217562, 0.12960384329325153, 0.10801887015515493, 0.069939221040249036, -0.015568583204407821, -0.093129102988786391, -0.11080294648244297, -0.11778514058790694, -0.11427105281496348, -0.085999792281954021, -0.082325788049823462, -0.078537848798928944, -0.046164761653629198, 0.011075584619134569, 0.10375693033957518, 0.16029963506351499, 0.13297507882166623, 0.047338032980167394, 0.0048895249436382831, 0.00069894275871357041, 5.63990224651297e-07, 1.6364483136122115e-07, 0.0, 3.5583973477001783e-05, 0.00037573866835065788, 0.0062919773295518977, 0.1024690848660872, 0.30842759318168067, 0.30857528457040106, 0.15421966708056467, 0.041490287152134604, -0.026039405425868391, -0.082093199917734214, -0.24344272030242287, -0.31986586842540121, -0.32094280825404542, -0.31235323978951096, -0.27170967424018416, -0.24890662245020131, -0.23849833015551253, -0.1762957585495144, -0.039989187745755127, 0.14688101917513233, 0.19772980337510554, 0.11632294946624629, 0.025011365024446293, 0.01396950349408967, 0.003724777354323847, 3.3313412133632469e-07, 2.9222291314503716e-08, 0.0, 4.4491529098487862e-06, 0.0029925969780475459, 0.053601013986728681, 0.27265582611908634, 0.41437543978495472, 0.30746966220651822, 0.086164860204073865, -0.079078973329062247, -0.14903512927304563, -0.15265402072518233, -0.26282487920737141, -0.38978692385573266, -0.38534458953645961, -0.37748575714029914, -0.31371134167368248, -0.18852661565937093, -0.11075034894578371, -0.096910339003067114, -0.034872397078679229, 0.017933432109295711, 0.073453617169146099, 0.038712991333856299, 0.020289443432361443, 0.04698701549550665, 0.078297766621912901, 0.022326179752490287, 0.0018605115701068706, 0.0, 0.0, 0.012166677335469916, 0.11317896511307811, 0.20311748085664572, 0.23450288844023737, 0.18019129583697208, 0.04354415963510673, -0.051947833800467254, -0.00026337370867836389, 0.016578023195988546, -0.063859108308559467, -0.20400156207344333, -0.23319129041249356, -0.18332063749878683, -0.07088941218977457, 0.046999936857389964, 0.19185789871312564, 0.2511004045372871, 0.14938325559628973, -0.023511261215419625, -0.15359226447525251, -0.10346293652368937, 0.08120444591491871, 0.17586433562928852, 0.20008261188302864, 0.10046762478577098, 0.0083723020654808931, 0.0, 0.0, 0.007537804944604847, 0.07663939134105166, 0.042481702932093648, -0.00043985135648487753, -0.060024953836098308, 0.080752106849910077, 0.1773095835340206, 0.20415600069493653, 0.27191139759670141, 0.099565966965125346, -0.10387542195928497, -0.14025826825974988, 0.0099483095085952638, 0.078903948476099037, 0.19112602995743466, 0.29451530518333385, 0.44199837631250688, 0.31825231671585891, 0.014530429137086222, -0.14004105442035628, -0.096936572613748384, 0.057020145190840969, 0.20183927337438329, 0.19256294750606032, 0.074420462804274556, 0.0055815347103206079, 0.0, 0.0, -0.016653996475815811, -0.087423671802234329, -0.051494425152504006, -0.16409965837656521, -0.10496865520867908, 0.030032231538989065, 0.18935867580012344, 0.29864942798863819, 0.22890266374305671, 0.087469898515149386, -0.13714133271146853, -0.16263944723768151, -0.079063408446577138, 0.00017531499802654117, 0.042540518635576542, 0.23318008593628087, 0.40702405636054878, 0.35950017234914244, 0.18323802877676534, 0.015605510950192634, -0.042744939264089794, -0.043364577637300158, 0.057160243032547096, 0.067720870989368742, 0.013023580990748074, 0.00093025578505343529, 0.0, 0.0, -0.068368349548312488, -0.2129150880498632, -0.21497467973607748, -0.12057675135556491, -0.031588553541018895, 0.01915078783828392, 0.16383236622802252, 0.16035690442001194, 0.11053097193770921, 0.056418825525733067, -0.045782417352032305, -0.12162637104785294, -0.091613154471656424, -0.064438717610832114, -0.038423899030294001, 0.13668818576287659, 0.29991241575533156, 0.30594942753999183, 0.15580572496226031, 0.11463401989859909, -0.050389763259424444, -0.18219551972958906, -0.1496668539453368, -0.012674230789503294, 0.0, 0.0, 0.0, 0.0, -0.10845153914478331, -0.25542947567783225, -0.23623279223835641, -0.033677518922012102, 0.084371301912422841, 0.12743678428061594, 0.12247600740914097, -0.04249663754739795, -0.15406025892561279, -0.012406661811027944, 0.08731196734889192, 0.10799694058869663, 0.051331426446264816, 0.13638131988954888, 0.26862484127422531, 0.15390725199054875, 0.074066229313523954, -0.033566984547586325, -0.012558188132308684, -0.030281829070014615, -0.13348617611136315, -0.25763030045924173, -0.21802113539415202, -0.057020912333855145, 0.0, 0.0, 0.0, -0.001118057104585395, -0.13640296716502162, -0.27965318623243196, -0.28212938143698102, -0.088452870387519186, 0.083291297338866491, 0.20750752205521789, 0.033824749258879031, -0.33414189353816831, -0.35608264603763906, 0.022243046668556626, 0.28232870481447925, 0.31703993447712642, 0.26401057217468182, 0.35842137492032888, 0.46198143483389842, 0.17884558729928762, -0.13116893740402841, -0.311230840542151, -0.20925277027404146, -0.12307900567344868, -0.15718627425585463, -0.24438482878805867, -0.2504447914271285, -0.097270968098929364, 0.0, 0.0, 0.0, -0.0078263997320977656, -0.16100022618175955, -0.30836052793535385, -0.29497844347039437, -0.16807335322767358, 0.032512804018900741, 0.13096725890656771, -0.17581717856082285, -0.45919629075444662, -0.30198087401429591, 0.29062356977856513, 0.54949105628008788, 0.50507393275850454, 0.37071860358201297, 0.31744231275802798, 0.20343831290936717, 0.044707724393518403, -0.3452100405814082, -0.39650426537181838, -0.22317179957068595, -0.12114980149653842, -0.15197928670953803, -0.24359325740219603, -0.2616253624729824, -0.11627793887688108, 0.0, 0.0, 0.0, -0.023479199196293293, -0.18011724517462349, -0.32127259514247203, -0.29238221114745033, -0.17654468426511863, -0.10784031951975305, -0.16662349803072832, -0.32547207630426611, -0.32027249242936329, 0.083122716429470903, 0.64687258762284261, 0.73594530473594, 0.76307671188280157, 0.50257792649852207, 0.24589738473752434, -0.024124390298649719, -0.30946890495463814, -0.44457649655281362, -0.39564690904808497, -0.19672370535471664, -0.11470512851032787, -0.16668100637480293, -0.25979045722935601, -0.25715313405464085, -0.11068765335395411, 0.0, 0.0, 0.0, -0.031305598928391062, -0.18636779470368753, -0.3320072047157413, -0.29205755594517085, -0.18753749333706995, -0.28662086125941227, -0.44690089800546534, -0.3103911934377076, 0.0558519917390006, 0.51984731405562434, 0.70389453445344174, 0.78323362475856795, 0.74073071391484846, 0.58221889991831566, 0.2543881004361182, -0.040992450989271928, -0.40476536392134255, -0.62205002030069412, -0.43499095125701676, -0.16339046056108719, -0.11217379074545257, -0.19620381080196153, -0.28461464658987845, -0.24261839169503072, -0.08720845415766082, 0.0, 0.0, 0.0, -0.021243084987122504, -0.17764342587711113, -0.34075563954310129, -0.31308211786830259, -0.26814564529251661, -0.41231682519172558, -0.48710527784631685, -0.13618089389164786, 0.37148853369731832, 0.68482616822292586, 0.74298378465710768, 0.69512384811458705, 0.66815945701767876, 0.48465847135908408, 0.25330359037116529, 0.1377027225287733, -0.313895865513382, -0.67292818984086833, -0.52687257263526921, -0.16371566437223464, -0.11503461030282991, -0.22210897544451941, -0.30169432683773173, -0.21913919249873742, -0.054784798124684356, 0.0, 0.0, 0.0, -0.0067083426275123701, -0.14903173788595434, -0.3344865818796513, -0.38300967225308286, -0.36968710287160317, -0.39298840486859099, -0.34025571879943389, -0.035827693206117735, 0.4290625008394518, 0.69919024833485943, 0.6752299451435636, 0.61795835950115552, 0.60600266531513158, 0.39518856000327607, 0.25265488338645675, 0.24627672569396031, -0.14007288148003977, -0.63292097686744531, -0.56641126212988058, -0.22283801307332757, -0.11889972412733876, -0.23293962529378481, -0.30036259465972692, -0.19230582198868795, -0.02906948471922027, 0.0, 0.0, 0.0, -0.001118057104585395, -0.089444579258431578, -0.29488080110924947, -0.45844039119918767, -0.46328280336613575, -0.29936579023648213, -0.23445695828902274, -0.085959371031742435, 0.35379574624356158, 0.67038873068899396, 0.59817045380437861, 0.43771741170477529, 0.42957557923674339, 0.42029818943631342, 0.29367525450997328, 0.20704634540830016, -0.055350809207023996, -0.476342559847381, -0.5419235812235047, -0.27159842349839297, -0.1254037165353975, -0.24417327741705105, -0.29384068446385009, -0.16882662279239466, -0.0044722284183415801, 0.0, 0.0, 0.0, 0.0, -0.022361150270815516, -0.18633182426905737, -0.41807276536583082, -0.47172783570354249, -0.31535384962966045, -0.19032643553787151, -0.13129653749007694, 0.29868036553375227, 0.61038454578661361, 0.49594478923353869, 0.25517905818969749, 0.29581446631206731, 0.42045193349409993, 0.30355873848983567, 0.13248550483188071, -0.099963599863957281, -0.35098915689163612, -0.41407368684074414, -0.21502443647296271, -0.13485338332244179, -0.24681793885625572, -0.27742613217917783, -0.14087519517775979, 0.0, 0.0, 0.0, 0.0, 0.0, -0.001118060511654006, 0.024040933164776009, -0.080362541464314291, -0.34496830391493927, -0.32365020170228104, -0.23435125709097054, -0.0569196152005466, 0.21529544432038547, 0.27622285529626739, 0.18934361959251672, 0.10849371465218699, 0.1987121711316662, 0.29640290494271532, 0.21784134908788591, -0.051540553034290199, -0.16991632754195218, -0.28261978525635739, -0.17738124345586503, -0.065455450289452335, -0.10865464635128931, -0.25706864811439456, -0.25491701984547005, -0.098389025203514752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0018605110022621005, 0.17646917426747483, 0.2090260409992622, -0.090972897175312512, -0.1895820060634939, -0.098472892462931144, 0.0012351166290914318, 0.057785514268660229, -0.13940267747307472, -0.23135829278934295, -0.1692533722384732, -0.057269998236439919, -0.029512208948706826, -0.037051337170106148, -0.18528468236506854, -0.24822377747612673, -0.1868206081446103, -0.0027022359385602359, -0.031928355754257898, -0.15605445462532944, -0.26690719091256992, -0.200131111455953, -0.036895884451318035, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015814348345908398, 0.18757364671494872, 0.28759864341614294, 0.21543406065123044, 0.12987937905004712, 0.19294369951681814, 0.13352989401323107, -0.025468829075061383, -0.25058851120486791, -0.41504203541750062, -0.31214007354307216, -0.26086275001803688, -0.15966165511395497, -0.12450578754939831, -0.057627117256245135, -0.041086101252807032, 0.068380709003570947, 0.041615476424739027, -0.068362865018677804, -0.23046646084267053, -0.23127128092421717, -0.083830967282409491, -0.0044722284183415801, 0.0, 0.0, 0.0, 0.0, 0.00019676287871995795, 0.046677746996214853, 0.19755003861735784, 0.23099559969690095, 0.29323657077000542, 0.3946169633788339, 0.35724665233151326, 0.10097797624356937, -0.089736754006260785, -0.22761959539655, -0.23824121631353731, -0.20788158237477747, -0.13015286659434896, -0.016526982417613804, 0.10660820528819928, 0.17357806737665221, 0.11886086600606667, 0.010372749578349398, -0.021918649417453497, -0.1613827285333595, -0.22065258301959292, -0.09142643192922939, -0.0088012326732169275, 1.2212913163785821e-05, 0.0, 0.0, 0.0, 0.0, 0.0017708659084796248, 0.061465402981718917, 0.18838530027498726, 0.17652155138014769, 0.15496413175176979, 0.30247983833830522, 0.28416753857360894, 0.0027493582155504919, -0.22374963591745251, -0.27504400943332968, -0.23444245293020868, -0.17734468302216633, -0.044205814049717004, 0.077816379328796731, 0.088066139302047625, -0.0032529513774634334, -0.081153351589531256, -0.12544160460566262, -0.14229002560782394, -0.14342381151730738, -0.058322269231700211, -0.0053166007449209152, 0.00022316323144735932, 6.8836419650429088e-05, 0.0, 0.0, 0.0, 0.0, 0.0059028909865003493, 0.037631423895813129, 0.088432725923471636, 0.0066814851173585422, 0.027387653052225982, 0.053937172324487775, 0.11800326459568516, -0.010780894047450799, -0.17777109780011061, -0.2583034531092952, -0.2741497062433102, -0.26347956697840591, -0.22338029010949975, -0.14114137013969222, -0.28281470732198077, -0.40759392196643518, -0.2951976822495978, -0.16587475997604337, -0.010883090851268628, 0.022003099457878195, 0.012352439665379434, 0.00027942427948145698, 0.00015194829692703223, 3.99695339905717e-05, 0.0, 0.0, 0.0, 0.0, 0.0011806038655031699, 0.009502191813399492, 0.019611279142422857, -0.053729053823557575, -0.091742696966258641, -0.082799867009986747, -0.0043120978415616138, 0.00095853829286612522, -0.023479206010430506, -0.11068766308843563, -0.1732988629732346, -0.20236834817917915, -0.22495160529811117, -0.30478865660733667, -0.43732987833511033, -0.43656882338750141, -0.23687728378132542, 0.067145574141019418, 0.15377340237443693, 0.070615685204056131, 0.022151545717154331, 0.00030585665592875914, 5.3538683101300902e-05, 5.5513241653571929e-06, 0.0, 0.0, 0.0, 0.0, 1.2718479027596071e-08, 3.4175114016752018e-06, 2.2372949339519806e-05, -0.047250484140531512, -0.15207099936429577, -0.20641652989744827, -0.17240901732072275, -0.048820545168848831, -0.012205136292212208, -0.018870982620530347, -0.057807498466967443, -0.1113042546147724, -0.1868986754747983, -0.29345872446405818, -0.32109567938353739, -0.24476203612426412, -0.025240944401707939, 0.1359610689786134, 0.16335721933528674, 0.098736448565178672, 0.011151677009028122, 0.00023131259612396886, 2.7852700314463867e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1562253661451004e-09, 1.2718479027596071e-08, 2.6593183421337221e-08, -0.0091838799790211652, -0.12580758784136672, -0.25184724316819129, -0.25899930438951485, -0.21414466403608717, -0.1742005816252106, -0.17863881300419643, -0.20082996989912755, -0.22413068463880567, -0.24854095722323033, -0.25963653567069578, -0.21858289541507325, -0.07766904913225961, 0.00082452358807648244, 0.087937916802968336, 0.15240115379091862, 0.082640044071822211, 0.0051346021890015204, 4.9268070957107177e-05, 4.2853865792609482e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.017752925515944953, -0.14424251981705338, -0.24188361015475088, -0.26629388273917537, -0.27517034549714714, -0.27406078765240149, -0.26407476704968225, -0.25186963075747032, -0.23411670524152473, -0.19195350714115597, -0.074340375598019856, -0.0066573470684793924, 0.0, 0.012107394342437671, 0.062448665555731149, 0.015930782029523249, 0.00063723128118093003, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

b = 0
values = 28*28

def load_weights(weights):
    global w
    w = weights

def sig(x):
    return 1 / (1 + np.exp(-x))

def dsig(x):
    return sig(x) * (1 - sig(x))

def plot_data():
    global data
    plt.axis([0, 6, 0, 6])
    plt.grid()
    for i in range(len(data)):
        point = data[i]
        color = '#000000'
        plt.scatter(point[0], point[1], c=color)
        
def NN(x):
    global w
    global b
    global values
    z = 0
    for i in range(values):
        z += x[i] * w[i]
    z += b
    return z

def test(x, sigmoid=True):
    if sigmoid:
        output = sig(NN(x))
        if output  > 0.5:
            print("Looks like an X to me! (I'm", int(100*output), "% sure)")
        else:
            print("Looks like an O to me! (I'm", int(100 - 100*output),"% sure)")
    else:
        output = NN(x)
        print(definition[0],":",output)
        
# training loop
def train(iterations, learning_rate):
    global w
    global b
    global data
    global answer
    global values
    global parameters
    
    values = len(data[0])
    
    w = []
    for i in range(values):
        w.append(0)
    
    costs = []
    
    for i in range(iterations):
        ri = np.random.randint(len(data))
        point = data[ri]

        z = NN(point)
        pred = sig(z)
        target = answer[ri]
        cost = (pred - target) ** 2
        costs.append(cost)
        
        dcost_dpred = 2 * (pred - target)
        dpred_dz = dsig(z)
        
        dz_dw = []
        for i in range(values):
            dz_dw.append(point[i])
        dz_db = 1
        
        dcost_dz = dcost_dpred * dpred_dz
        
        dcost_dw = []
        for i in range(values):
            dcost_dw.append(dcost_dz * dz_dw[i])
        
        dcost_db = dcost_dz * dz_db
        
        for i in range(values):
            w[i] = w[i] - learning_rate * dcost_dw[i]
        b = b - learning_rate * dcost_db
        
    plt.plot(costs)
    print("Final Cost:", cost)
    f = open("Weights.txt", "w")
    f.write(str(w))
    f.close()
    
    
    
############################################################################    
data=[[3, 1, 7],
      [1, 0, 5],
      [6, 1, 8],
      [2, 2, 3],
      [4, 1, 7],
      [0, 0, 4],
      [7, 2, 9],
      [3, 2, 3]]

answer = [1,
          0,
          1,
          0,
          1,
          0,
          1,
          0]

definition = ["O", "X"]

############################################################################